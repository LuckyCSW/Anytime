<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.naver.anytime.mybatis.mapper.TimeTableMapper">
   
	   <select id = "gettimetable" resultType="TimeTable">
		  select *
		  from timetable
		  where user_id = #{user_id}
		  and status != 0  
		</select>
	   
	   <select id="getTimetablesBySemester" resultType="TimeTable">
		    SELECT *
		    FROM timetable
		    WHERE semester = #{semester} AND user_id = #{user_id} 
		    AND status != 0  
	   </select>
	   
	   <!-- <select id = "getTimetableByUserId" resultType="TimeTable">
	     SELECT TIMETABLE_ID, USER_ID, NAME, SEMESTER, 
	     		TO_CHAR(TIMETABLE_DATE,'MM/DD HH24:MI') as TIMETABLE_DATE, STATUS
	     FROM TIMETABLE
	     WHERE user_id = #{user_id}
	     AND status != 0  
	   </select>
	   
	   <update id="changeName" parameterType="map">
		    UPDATE TIMETABLE 
		    SET NAME = #{newName} 
		    WHERE timetable_id = #{timetable_id}
	   </update>
	   
	   <update id="changeNameAndTime" parameterType="TimeTable">
	        UPDATE TIMETABLE 
	        SET NAME = #{NAME}, TIMETABLE_DATE = TO_DATE(#{TIMETABLE_DATE}, 'YYYY-MM-DD HH24:MI:SS')
	        WHERE TIMETABLE_ID = #{TIMETABLE_ID}
       </update>
       
       <insert id="insert" parameterType="TimeTable">
	      INSERT INTO TIMETABLE (TIMETABLE_ID, USER_ID, NAME, SEMESTER, TIMETABLE_DATE, STATUS)
	      VALUES (#{TIMETABLE_ID}, #{USER_ID}, #{NAME}, #{SEMESTER}, SYSDATE, #{STATUS})
   	   </insert>
   	   
   	   <select id="getLastTimeTableId" resultType="int" parameterType="int">
	      SELECT MAX(TIMETABLE_ID)
	      FROM TIMETABLE
	      WHERE USER_ID = #{USER_ID}
      </select>
      
      <select id="getTimetableByUserIdAndSemester" resultType="TimeTable">
	    SELECT TIMETABLE_ID, USER_ID, NAME, SEMESTER, 
	           TO_CHAR(TIMETABLE_DATE,'MM/DD HH24:MI') as TIMETABLE_DATE, STATUS
	    FROM TIMETABLE
	    WHERE user_id = #{user_id} and SEMESTER = #{semester}
	    AND status != 0  
	  </select>
	
	  <insert id="createDefaultTimeTable" parameterType="TimeTable">
	      INSERT INTO TIMETABLE (TIMETABLE_ID, USER_ID, NAME, SEMESTER, TIMETABLE_DATE, STATUS)
	      VALUES (#{TIMETABLE_ID}, #{USER_ID}, '시간표 1', #{SEMESTER}, SYSDATE, #{STATUS})
	  </insert> -->
   
	
</mapper>